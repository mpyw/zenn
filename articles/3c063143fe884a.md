---
title: "TypeScript ã§ã€Œã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§æ¸¡ã•ãªã‹ã£ãŸå¼•æ•°ã ã‘å¾Œã§å¿…é ˆã«ã™ã‚‹ã€ã®å‹åˆ¶ç´„ã‚’æ›¸ã"
emoji: "ğŸ§©"
type: "tech"
topics: ["javascript", "typescript", "å‹", "å‹ãƒ‘ã‚ºãƒ«"]
published: true
publication_name: "yumemi_inc"
---

## å®Ÿè£…

```ts
/**
 * [Î±] T å‹ã‹ã‚‰ undefined ä¸å¯ã‚­ãƒ¼ã® union ã‚’æŠ½å‡º
 */
type RequiredKeys<T> = {
  [K in keyof T]-?: Record<any, unknown> extends Pick<T, K>
    ? never
    : K;
}[keyof T];

/**
 * [Î²] Î± ã‚’åˆ©ç”¨ã—ï¼Œ Passed å‹ã‹ã‚‰ Req å‹ã®æ¡ä»¶ã‚’æº€ãŸã•ãªã„ã‚‚ã®ã ã‘ã‚’æŠ½å‡º
 */
type MissingKeys<Req, Passed extends Partial<Req>> = {
  [K in keyof Pick<
    Req,
    RequiredKeys<Req>
  >]: Passed[K] extends Req[K] ? never : K;
}[keyof Pick<Req, RequiredKeys<Req>>];

/**
 * [Î³] Î² ã‚’åˆ©ç”¨ã—ï¼Œ ã€Œundefined ä¸å¯ã®ä¸è¶³ã—ã¦ã„ã‚‹ã‚µãƒ–ã‚»ãƒƒãƒˆã€ã¨ã€Œãã‚Œä»¥å¤–ã®ã‚µãƒ–ã‚»ãƒƒãƒˆã€ã‚’æŠ½å‡º
 *     å¾Œè€…ã«å¯¾ã—ã¦ã®ã¿ undefined ã‚’è¨±å¯ã—ã¦å‹ã‚’åˆæˆã™ã‚‹
 */
type RequireMissingSubset<Req, Passed extends Partial<Req>> = Pick<
  Req,
  MissingKeys<Req, Passed>
> &
  Partial<Omit<Req, MissingKeys<Req, Passed>>>;
  
/**
 * Î³ ã‚’åˆ©ç”¨ã—ï¼Œ å¯å¤‰é•·ãƒªã‚¹ãƒˆã§å¼•æ•°è‡ªä½“ã‚’çœç•¥å¯èƒ½ã‹è¡¨ç¾ã™ã‚‹
 */
export type RequireMissing<Req, Passed extends Partial<Req>> =
  Record<any, unknown> extends RequireMissingSubset<Req, Passed>
  ? [options?: RequireMissingSubset<Req, Passed>]
  : [options: RequireMissingSubset<Req, Passed>];
```

:::message
ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿å¼•æ•°ã‚’å³æ ¼ã«ã™ã‚‹ãŸã‚ã«ï¼Œä»¥ä¸‹ã®ã€Œä½™åˆ†ãªã‚­ãƒ¼ãŒç„¡ã„ã‹ã€ã®ãƒã‚§ãƒƒã‚¯ã‚’ä½µç”¨ã—ã¾ã™ã€‚
```ts
export type Exact<T, Shape> = T extends Shape
  ? Exclude<keyof T, keyof Shape> extends never
    ? T
    : never
  : never;
```
:::


## ä½¿ã„æ–¹

```ts
// ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ä½œæˆã«å¿…è¦ãªé …ç›®
type Profile = {
  name: string;         // åå‰ï¼ˆ*å¿…é ˆ*ï¼‰
  age: number;          // å¹´é½¢ï¼ˆ*å¿…é ˆ*ï¼‰
  url?: string;         // URLï¼ˆä»»æ„ï¼‰
  description?: string; // è‡ªå·±ç´¹ä»‹ï¼ˆä»»æ„ï¼‰
}

// â†“ ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‹ã‚‰æ¨è«–ã•ã‚Œã‚‹å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä¸ãˆã‚‹
class ProfileFactory<O extends Partial<Profile>> {
  // â†“ ã™ã¹ã¦ Nullable ã«ã—ã¦ãŠã
  private readonly name: string|null;
  private readonly age: number|null;
  private readonly url: string|null;
  private readonly description: string|null;

  // â†“ æ¨è«–ã•ã›ã‚‹å¯¾è±¡
  constructor(options?: Exact<O, Partial<Profile>>) {
    this.name = options?.name ?? null;
    this.age = options?.age ?? null;
    this.url = options?.url ?? null;
    this.description = options?.description ?? null;
  }

  // â†“ ä½œæˆæ™‚ã«æ¸¡ã•ã‚Œãªã‹ã£ãŸå¿…é ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ RequireMissing ã‚’ç”¨ã„ãŸã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã§è¦æ±‚
  public create(...args: RequireMissing<Profile, O>): Profile;

  // â†“ å®Ÿéš›ã¯çœç•¥å¯èƒ½ãª Partial<Profile> å‹ã¨ã—ã¦å—ã‘å–ã‚‹
  public create(options?: Partial<Profile>): Profile {
    return {
      name: options?.name ?? this.name,
      age: options?.age ?? this.age,
      url: options?.url ?? this.url,
      description: options?.description ?? this.description,
    } as Profile; // â†ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ãŒå¿…è¦
  }
}

// å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ãƒ•ã‚¡ã‚¯ãƒˆãƒªã§åŸ‹ã‚ã‚‰ã‚Œã¦ã„ã‚‹
const factory1 = new ProfileFactory({
  name: 'Bob',
  age: 20,
});
// ç©ºã§ä½œã‚Œã‚‹
factory1.create({});
// å¼•æ•°è‡ªä½“ã‚’çœç•¥ã—ã¦ã‚‚ä½œã‚Œã‚‹
factory1.create();
// éƒ¨åˆ†çš„ã«å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã—ã¦ã‚‚ä½œã‚Œã‚‹
factory1.create({
  name: 'Bob',
  url: 'https://example.com/',
});
// å…¨éƒ¨æŒ‡å®šã—ã¦ã‚‚ä½œã‚Œã‚‹
factory1.create({
  name: 'Bob',
  age: 20,
  url: 'https://example.com/',
  description: 'hello',
});

// å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒãƒ•ã‚¡ã‚¯ãƒˆãƒªã§ä¸è¶³
const factory2 = new ProfileFactory({
  age: 20,
});
// è¶³ã‚Šãªã„ã‚‚ã®ã‚’è£œãˆã°ä½œã‚Œã‚‹
factory2.create({
  name: 'Bob',
});
// éƒ¨åˆ†çš„ã«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã—ã¦ã‚‚ä½œã‚Œã‚‹
factory2.create({
  name: 'Bob',
  url: 'https://example.com/',
});
// å…¨éƒ¨æŒ‡å®šã—ã¦ã‚‚ä½œã‚Œã‚‹
factory2.create({
  name: 'Bob',
  age: 20,
  url: 'https://example.com/',
  description: 'hello',
});
// ç©ºã§ã¯ä¸å¯
factory2.create({});
// å¼•æ•°è‡ªä½“ã‚’çœç•¥ã™ã‚‹ã¨ä¸å¯
factory2.create();

// ãƒ•ã‚¡ã‚¯ãƒˆãƒªã«ä½•ã‚‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒä¸ãˆã‚‰ã‚Œã¦ã„ãªã„
const factory3 = new ProfileFactory();
// å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ã™ã¹ã¦æŒ‡å®šã™ã‚Œã°ä½œã‚Œã‚‹
factory3.create({
  name: 'Bob',
  age: 20,
});
// å…¨éƒ¨æŒ‡å®šã—ã¦ã‚‚ä½œã‚Œã‚‹
factory3.create({
  name: 'Bob',
  age: 20,
  url: 'https://example.com/',
  description: 'hello',
});
// å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒè¶³ã‚Šãªã‘ã‚Œã°ä¸å¯
factory3.create({
  name: 'Bob',
  url: 'https://example.com/',
});
// ç©ºã§ã¯ä¸å¯
factory3.create({});
// å¼•æ•°è‡ªä½“ã‚’çœç•¥ã™ã‚‹ã¨ä¸å¯
factory3.create();

// ä½™åˆ†ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä¸ãˆã‚‹ã¨ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã‚¨ãƒ©ãƒ¼
const factory4 = new ProfileFactory({
  name: 'Bob',
  age: 20,
  foo: 123,
});

// ä½™åˆ†ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ä½œæˆæ™‚ã«ã‚‚ã‚¨ãƒ©ãƒ¼
const factory5 = new ProfileFactory({
  name: 'Bob',
  age: 20,
});
factory5.create({
  foo: 123,
});
```

**[Playground ã§å‹•ä½œç¢ºèª](https://www.typescriptlang.org/ja/play?#code/PQKhFgCgAIWhtQjcAF1oBVqGj1Q0gyEiGaArgHYAmApgGYCWRZJ0gsHKD3yoLUMgPwyB2DIUVQPZHRASQyBeo0BfilFjAoAFwCeABzLQASmQCOBKgCc6AaTKyAzgB40APmgBeaAG8JCXdBrQA1gd4V0yALQB+AFwqZADGvFokxgCGRLIANNwuRLwA7kQWZAAe0mSkhtAAClTBLqbxumb20NC+0LQAbmRaldCBugDcUAC+8G6yHl4dkFCgEDBw8IBNwKiIQoCUSoAUroDqDIAw-wWRhoZ0WHhBalgcgIbmgG9ygoABdoD6DICqDIBWDIAiDIBBDByABgyAigwi4mNSkHKK0ACyVA2NAA5vojMZVGp4vl1pt6Jlsrk1lppFRIgAbCHqMwWax2GAOJwCXr9QrFYzNSGxSnqTQ6EhgkyQioEszIQIwjZ0eC6VAInIkPKQnmoGr1RotaDtLo9dyeMklKm7Ol6AxM7FswbDMAScaAZuBUBM5ktVoAYBmI5GotHozA4DEAzbGLQBmDLdANEMgFaGQBrDIBuhkAwwyACYZALAMgAsGU2AXQZADEMgFO5QBomhwvX6g+9dVVU4AY-UAoAGAawZAH-azo4gH8GbiWmhbQSARiimM7MIJABAqgAQjQCaDK7dV8fkpISqAUCiMCAMoEABGm2kWKhay58KyAryMJRaMxzNxBSKJXsVPs3cMIMZY+hsLoLIsADJ7HPURjjAB5AC2VFHSq3O7Ve4ncJxZkGVW1o1g0D1xorNATCAJCagDuqYAVwyAJ0M-qAOYMgCo+oADqaAFeBgDK8oIgCA7oApq5MIAvwHYIAFhGAH-OzatlAmTyGE0jQO2yraGQT69q+nJwtA-JIueC5jjiVjriEYQRNEcQJEkqTpNOSKdvRjH9kOI7MQeJAslUNTwLw8iovwhgBHROgyQOw5kA+6j7pObL2IEakaXwRCGIEUl6YC269gZ8lKixh7IFqkAUVRNEKEoACiGSRMEo5oPEfYABaRIoy4YOxgrQNFsVkPYNTBcE6IEOQxgkp4EWuHKyUxXFbESUl4pNASKnoM0gRVRZtRkA0WjecAwDQIA6wyALcMgCrDIAxQxsIA1wyADry9ZZoAo-qAIGR1yAKAZgB3bjIAUFFoHhUOiSh4vYRCRDeZCBIY0haCCbSpudVQddAgCwKoAskqABD-ICTYAEBkgIAkP-2JEwIHbUBA3oOjRnRd51XYALnqAEb5j0ve99gEFo6I6UdJ29kDwPQFdACqygADL3YA33KAPCGH0EuQhjBCd1n8Ijx2nejnXIYAj7qAJy+gDTcvjRNdFAwydYAyYTQIAzQyAM8MMGAJcMgD1DIA-Qx4IAFcaAGtRlwRq6mCAIsMIuAIcMbAS4IgBwcoAEgwtpAWWwqt62bQAYqF0hhLI17lYiSWcZe+RrdQm08fil289AjaAJ4MTrQAAcgQ6LopEg6bdAWbOoAUgyAPIM9jyCddSRNk0A6JEJD8Oisi1HtP1IyCAA+RDB+iX7QInVDJ6n6eZ0Q2fQF9P0l-9jTF6X5eV9XSi11nOdw+ih00727ch53Scpz3ZAZ330Ck+TVCU0QQ-I8Co9l1zBJXXzcuXIA2gyujmgCGMfYoS2cdBBhWEAAU6mabZOnBZb177vOTsuxtZA4gAlLYzTSFFQEAA6Xa+0rDQDvjZbSIC87VDFB3f+gDDBAKbuAyBWlfAoO+nA36Y9EHAIHmgpe0DCG+HgXgmqNEkFAPnhTe+RD77QNoYvehZDcEbwJJ0TentoB83GoAITMsyAEI7BW1xsCAGMGc4L1ABVDF1QA7QyAHOGQWghdIMSciCIQ8xbjnGkWwQACwxsB6mwQAkwywWmoAIRsE5DnREUaA5Np7ZGvkA5xkQtDAjsqomSxhnamzIPEK8Zhv4cg-ptbyPC+aAHztQA2WmAHsGbCeFrjIgvJiHxrsv5YGDM6QA68ovEAGvKBsqjyGsbY+xk9b7EJ0o7FJISv5BJNmkv+lCdDSDhgID2F1QE-XQQ-GBYC2EAOAZ06klCqhN0CN06BqD+nUKbsM4GA9xkVKAaQmoAzkEDzmRdZhS9FmMMwds1hqzqEHJspsqonRG6zhqWdK6gAEwkAEUM7o2CKMFoAGQYZr2C4ZAL53NoAvVVhrCWMS+qAEKGMW-oIKwUANPqgBAhlwBGF0Bsz5HWgBQS21sACM4DaDJHqZ-C2V8tCyGvu0zpgQADkAAhXgg5yWbLGdAAATAABmGZ0b+gwrqAC8vWCo1FZQDRYS2QGKgGlMcTYdlnLOpITQphLCzp7h8oNoKq2RKRVirINfDlvzAAXCYAMCVAAhblNZ6ALNaCF0QYkWgAShmMQqpVAr0VqtFencVO084UupbSzZCzoDkqitIaQ8g7IdUyHteQm1RW8BvMAOlXRtWQCuoAC0UdWAHBjQAWdp2v5ZAFVmLnUOM1aS91vrPWxoJAyll3r4YUv9YG4NwBQ03nDWQSN0bS1VBOfwatZAQ68FLZKzeV1-nq01q80F4LIUOigMi6iOaiWMuxWQXFqT8WOuJe08trK41SugPaQAUQx3EeIIQAOxG60AA4M9rs2rsZXmsphb9oeppX2+NV19VGtkS801WsLVsGtbap0iqs2ztkNejVJK3X3uLY+ytg9fU1qDf4ENIVG0RtCK2tlz7OrJvTZm5VV6b2uoJGSyDXrPrfUCBW2GVbYMBvg4hsNKGo0xs2R25esHu3ol7eh7dPKYnMAdUKkDLqC39oTdKlC6FsLNmDHxy9An8Oavjb8sdEKsyAFV5e4n7Xl63hS6O4U6tIztXQAZgXUumpBLVXEow38k1w6ta+ydOmxsEZz2AeM-JsDhGi1Uqg6Rn6FHvnWawxm-9F6gNGY83en6PmSNlrI0yzdBIfV+po3WhtTaW1MfsCxrtPan3bqHYC15e7rgvBczJ8LkXwPRZLdB6tqWEP1qQxl1DWXAvcdgrxpg-HLMRdAxK6zMqJNYSkxV9zoHFOiegIATXk9XXE-TrfWwYhai0lrBQAFQwizYPp8+qLV0ABZTN4vNquzzVQiMxbbY3eLAWqgUF4LwQIGLGVGa4wOzqs35t2ZiQIrM9xNvbcNgZvbQqACsR3l0naFWd3OEHLv0pu4lkTQHQdVYJPdx70Bnuva3UAA)**

:::message
ãƒˆãƒ³ãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«å¾Œã« JavaScript ã‹ã‚‰åˆ©ç”¨ã•ã‚Œã‚‹ã“ã¨ã‚‚æƒ³å®šã™ã‚‹å ´åˆï¼Œé›‘ã«ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã›ãšã«ä¸å¯§ã«å®Ÿè¡Œæ™‚ã®å‹ãƒã‚§ãƒƒã‚¯ã‚‚æ›¸ãã»ã†ãŒã‚ˆã‚Šå®‰å¿ƒã§ã™ã€‚

```ts
public create(...args: RequireMissing<Profile, O>): Profile;
public create(options?: Partial<Profile>): Profile {
  const name = options?.name ?? this.name;
  if (name === null) {
    throw new Error('Missing parameter: name');
  }

  const age = options?.age ?? this.age;
  if (age === null) {
    throw new Error('Missing parameter: age');
  }

  const url = options?.url ?? this.url;
  const description = options?.description ?? this.description;
  
  return { name, age, url, description };
}
```
:::

**Special Thanks: [@uhyo](https://zenn.dev/uhyo) ã•ã‚“** ï¼ˆæ”¹è‰¯ã«å”åŠ›ã—ã¦ã„ãŸã ãã¾ã—ãŸï¼‰