**Claude Code が応答する際には，必ず以下のフォーマットで Claude の利用状況を記載してください。**

```text
---
🤖 Generated by Claude (Model: [model-name])
📊 Estimated tokens: ~[input-tokens] input + ~[output-tokens] output
💰 Estimated cost: ~$[estimated-cost] USD
```

このセクションを抜けると，本指示が始まります。

---

# Zenn 記事執筆スタイルガイド

このドキュメントは，Claude Code が Zenn の技術記事を執筆する際の指針です。既存記事の分析から抽出された執筆スタイルの特徴を詳細に言語化しています。記事を執筆する際は，必ずこの指針に従って一貫性のある文体・構成を維持してください。

## 最重要ルール

### 句読点
- **読点は必ず「，」（全角カンマ）を使用** - これが最も特徴的なスタイル
- 「、」は基本的に使用しない
- 句点は「。」（全角句点）を使用

### 分かち書き
- **半角英数字の前後には必ず半角スペースを入れる**
  - 正：「Laravel の FormRequest バリデーション」
  - 正：「1 つのモノリスの中で」
  - 誤：「Laravelの FormRequestバリデーション」

---

## 1. 文体の基本方針

### 1.1 語尾の使い分け

- **基本は「ですます」調**
  - 読者への説明・解説：「〜します」「〜してください」「〜しましょう」
  - 例：「以下では，代表的な日付時刻関連のデータ型をピックアップしていきましょう。」
  - 例：「Postgres を使ってください。」

- **「である」調との併用**
  - 箇条書き内の説明：「〜である」「〜となる」
  - 技術的な定義・事実の記述：「〜を指す」「〜に相当する」
  - 例：「ロック処理は全て **悲観的制御** である。」
  - 例：「これはよくあるアプローチだと思います。」

- **断定調の使用**
  - 重要な推奨事項：「〜してください。」「〜です。」
  - 強い主張：「〜してはならない」「〜すべきである」
  - 例：「**Postgres を使ってください。**」
  - 例：「デフォルトの `READ COMMITTED` のまま使用せよ。」

### 1.2 一人称の使用

- **「私」を使用**
  - 個人的な経験・意見を述べる場合
  - 例：「最近 𝕏 で， Go のプロジェクトで起こっていたタイムゾーンに起因するトラブルをきっかけとして話を広げていったポストがありましたが，そのとき意外と反響がありました。」
  - 例：「私は必須とまでは考えていません。」

- **「筆者」も使用可能**
  - よりフォーマルな文脈で
  - 例：「要点を筆者なりに整理すると，以下のようになる。」

### 1.3 読者への語りかけ

- **問いかけ形式**
  - 「〜でしょうか？」で考えを促す
  - 例：「これを分解するとどうなるでしょうか？こうでしょうか？」
  - 例：「…いったい何が問題になるのでしょうか？」

- **呼びかけ表現**
  - 「〜してください」「〜しましょう」で行動を促す
  - 「みなさん」「皆様」で読者を尊重
  - 例：「みなさんは決して同じ轍を踏まないでください。」

### 1.4 強調表現の使い方

- **副詞による強調**
  - 「非常に」「かなり」「極めて」「圧倒的に」
  - 「端的に」「明らかに」「明確に」
  - 例：「Postgres 固有のローレベルなチューニング・メンテナンスのことは殆ど考えなくていいようになってきていると感じます。」

- **感嘆符・疑問符の使用**
  - 全角の「！」「？」を使用
  - 控えめに使用し，重要な箇所でのみ
  - 例：「手作業で書くならこんなコード見たくないですよね？こうあってほしいですよね？」

---

## 2. 句読点の使い方（重要）

### 2.1 読点の使用

- **「，」（全角カンマ）を主に使用**
  - これが最も特徴的なスタイル
  - 「、」は基本的に使用しない
  - 例：「最近 𝕏 で， Go のプロジェクトで起こっていたタイムゾーンに起因するトラブルをきっかけとして話を広げていったポストがありましたが，そのとき意外と反響がありました。」
  - 例：「まず Laravel にフォーカスした話をする前に，データベース上での日付時刻のデータ型の選び方というアプローチからこの記事を書こうと思ったのですが，さらにその前に使用する RDBMS を決めなければなりませんね。」

### 2.2 句点の使用

- **「。」（全角句点）を文末に使用**
  - 箇条書きの各項目の末尾にも付ける場合がある
  - 体言止めの場合は付けない

### 2.3 中黒の使用

- **「・」で並列項目を区切る**
  - 例：「日付時刻・タイムゾーン」
  - 例：「HTTP アクセスを捌くサービス。要するにルーティング+コントローラ+コントローラに近い雑多なロジックもろもろ。」

---

## 3. 分かち書き（スペーシング）（重要）

### 3.1 英数字の前後

- **半角英数字の前後には必ず半角スペースを入れる**
  - 例：「最近 𝕏 で， Go のプロジェクトで」
  - 例：「Laravel の FormRequest バリデーション」
  - 例：「PHP の `array` は全て言語仕様上は連想配列」
  - 例：「1 つのモノリスの中で」
  - 例：「2 つの特性」

- **例外：句読点の直前**
  - 文末の括弧の前にはスペースを入れない
  - 例：「データ型をピックアップしていきましょう。」

### 3.2 記号・括弧の前後

- **開き括弧の前にスペース，閉じ括弧の後にスペース**
  - 例：「トランザクションデータには，原則的にタイムゾーンを考慮したデータ型を採用する」
  - ただし文末の括弧の前後は例外的にスペースなしの場合もある

---

## 4. コードの記述スタイル

### 4.1 インデント

- **スペース4つでインデント**
  - タブではなくスペースを使用
  - Go の記事では「Web ブラウザ上での見やすさに配慮して半角スペースを採用しています」と断り書きを入れる
  - 例（記事内の注釈）：
    ```
    :::message alert
    Go ではタブインデントが推奨されていますが，この記事では Web ブラウザ上での見やすさに配慮して半角スペースを採用しています。
    :::
    ```

### 4.2 コメント

- **日本語コメントを多用**
  - 説明的で丁寧なコメント
  - 良い例・悪い例を明示
  - 例：
    ```php
    // カーソルの初期値は NULL
    $cursor = null;

    // 現在のカーソルにおけるページを取得
    $response = $this->client->getMembers($cursor);

    // 悪い例
    // echo $time->format('Y-m-d H:i:s');

    // 良い例
    echo CarbonImmutable::instance($time)
        ->setTimeZone($this->tz)
        ->format('Y-m-d H:i:s');
    ```

### 4.3 変数名・関数名

- **キャメルケース**
  - 例：`$userId`, `$userName`, `getUserByID()`
  - わかりやすい英語の命名を心がける

### 4.4 SQL

- **キーワードは大文字**
  - 例：`SELECT`, `FROM`, `WHERE`, `INSERT`, `UPDATE`
  - 適切な改行で読みやすく
  - 例：
    ```sql
    SELECT
        -- 2023-09-01 00:00:00
        -- → 2023-09-01 00:00:00+00
        '2023-09-01 00:00:00'::timestamp AT TIME ZONE 'UTC',

        -- 2023-09-01 00:00:00
        -- → 2023-09-01 00:00:00+09
        -- → 2023-08-31 15:00:00+00
        '2023-09-01 00:00:00'::timestamp AT TIME ZONE 'Asia/Tokyo';
    ```

### 4.5 コード例の提示

- **良い例・悪い例の対比**
  - コメントで「悪い例」「良い例」と明示
  - コメントアウトで悪い例を示すこともある
  - 例：
    ```php
    // 悪い例
    // return CarbonImmutable::instance()->startOfDay();

    // 良い例
    echo CarbonImmutable::instance($time)
        ->setTimeZone($this->tz)
        ->startOfDay();
    ```

- **diff 形式での変更提示**
  - 修正前後を対比する場合
  - 例：
    ```diff
    - yield from $response->members();
    + foreach ($response->members() as $member) {
    +     yield $member;
    + }
    ```

- **実行結果の記載**
  - コメントで期待される出力を示す
  - 例：
    ```php
    // 1ページ目
    /* $response->members()    #=> */ [new Member(id: 1), new Member(id: 2)];
    /* $response->nextCursor() #=> */ 'xxx';
    ```

---

## 5. 文書構成

### 5.1 見出し構造

- **階層的な見出し**
  - `#` 〜 `####` を適切に使い分け
  - 見出しは簡潔で分かりやすく
  - 見出しの末尾に句点「。」は付けない

### 5.2 導入部の書き方

- **「# はじめに」セクション**
  - 記事の背景・動機を説明
  - 個人的な体験や問題意識を共有
  - 対象読者を明示することもある
  - 例：
    ```markdown
    # はじめに

    最近 𝕏 で， Go のプロジェクトで起こっていたタイムゾーンに起因するトラブルをきっかけとして話を広げていったポストがありましたが，そのとき意外と反響がありました。 その一方で，時間をかけて設計された社内の PHP プロジェクトでは比較的トラブル少なく解決できているので，その知見を共有していこうと思います。
    ```

- **対象読者の明示**
  - 例：「**対象読者: PHP（とくに Laravel や Symfony）でそこそこイケてる設計を実践してきた Go 初心者の方々**」
  - 例：「# 読者対象」というセクションを設ける場合もある

### 5.3 記事の展開パターン

1. **問題提起・背景説明**
   - 「〜という問題があります」
   - 「〜について考えてみましょう」

2. **理論的な説明**
   - 「〜とは何か」
   - 「〜の仕組み」

3. **具体例の提示**
   - 「具体例から見る〜」
   - 実際のコード例

4. **実装方法・ベストプラクティス**
   - 「推奨される実装パターン」
   - 「準備編」

5. **注意点・落とし穴**
   - 「ハマりポイントと回避方法」
   - 「問題点」

6. **まとめ**
   - 要点を箇条書きで整理
   - 例：
     ```markdown
     # まとめ

     - **Go はコンテキストが非常に強力な情報伝達手段。とりあえず第1引数で受けることを常に頭に入れておこう！**
     - **使用範囲が広いものは，安直にコンストラクタインジェクションせずにコンテキストに入れることを考えろ！**
     ```

### 5.4 参考文献の提示

- **URL をそのまま貼る**
  - 説明テキストは書かない場合が多い
  - 複数のリンクを列挙する
  - 例：
    ```markdown
    https://itmanabi.com/transaction-isolation/

    https://itsakura.com/sql-isolation

    https://qiita.com/song_ss/items/38e514b05e9dabae3bdb
    ```

- **リンクへの誘導**
  - 「以下のリンクを参照されたい」
  - 「詳しくは〜を参照」

---

## 6. 強調・注意の表現

### 6.1 Markdown の強調

- **太字の多用**
  - `**太字**` で重要箇所を強調
  - 1 文の中でキーワード部分だけを太字にする
  - 例：「**Postgres を使ってください。**」
  - 例：「これは **楽観的制御** と呼ばれる。」

- **太字イタリックの使用**
  - `***太字イタリック***` でさらに強調
  - 例：「***Postgres を使ってください。***」

- **コードフォーマット**
  - バッククォートで囲む：`` `変数名` ``, `` `関数名()` ``
  - 技術用語，コマンド，データ型などに使用
  - 例：「`timestamptz` のデータ型について」

### 6.2 Zenn 記法の活用

- **補足情報ブロック**
  ```markdown
  :::message
  ちなみにこの `'request'` という文字列ですが，...
  :::
  ```

- **警告ブロック**
  ```markdown
  :::message alert
  **`REPEATABLE READ` 以上でも，Locking Read/Write では `READ COMMITTED` でロックを取る相当の動作になってしまう仕様となっている。**
  :::
  ```

- **折りたたみブロック**
  ```markdown
  :::details app/Database/Eloquent/Casts/LocalDate.php

  （Larastan 用の注釈を入れています）

  ```php
  // コード
  ```
  :::
  ```

### 6.3 箇条書きの使い方

- **`-` を使用（`*` は使わない）**
  - 例：
    ```markdown
    - 基本は「ですます」調
    - 「である」調との併用
    ```

- **ネスト構造**
  - スペース2つでインデント
  - 例：
    ```markdown
    - レベル1
      - レベル2
        - レベル3
    ```

- **箇条書き内の強調**
  - 項目の冒頭を太字にする
  - 例：
    ```markdown
    - **基本は「ですます」調**
      - 読者への説明・解説：「〜します」「〜してください」「〜しましょう」
    ```

---

## 7. パラグラフ命名のパターン

### 7.1 問いかけ形式

- **「〜とは？」**
  - 例：「## Laravel の FormRequest とは？」
  - 例：「### SIRead ロックとは？」

- **「〜はどうなっているか？」**
  - 例：「## FormRequest が実際に解決される動き」
  - 例：「# MySQL/Postgres の実装はどうなっているか？」

- **「〜を選択すればよいか？」**
  - 例：「# どのトランザクション分離レベルを選択すればよいか？」
  - 例：「## 具体例から見るデータ型の選び方」

### 7.2 動詞形式

- **「〜を理解する」「〜を整理する」**
  - 例：「# 理論面の前提知識」
  - 例：「## クラスの依存関係を確認」

- **「〜について」**
  - 例：「# データベースについて」
  - 例：「## 準備編」

### 7.3 体言止め・名詞形式

- **問題・解決策の提示**
  - 例：「## 問題のある実装パターン」
  - 例：「# 推奨される実装パターン：コンテキストの利用」

- **説明的なタイトル**
  - 例：「## 各種変換処理」
  - 例：「### Carbon のフォーマット処理に注意！」

### 7.4 その他の特徴的な見出し

- **「〜とまとめ」**
  - 例：「# まとめ」
  - 例：「#### 総評」

- **「コラム」**
  - 例：「# コラム」で補足情報を提供

- **「謝辞」**
  - 例：「# 謝辞」で協力者への感謝

---

## 8. 表（テーブル）の使い方

### 8.1 基本的な表の構造

- **ヘッダー行の中央揃え・左揃え**
  - `:---:` で中央揃え
  - `:---` または `:----` で左揃え
  - 例：
    ```markdown
    | データ型          | 説明                                              | 例                        |
    |:--------------|:------------------------------------------------|:-------------------------|
    | `date`        | 日付                                              | `2023-09-01`             |
    ```

### 8.2 複雑な表の作成

- **セル内改行**
  - `<br>` タグで改行
  - 例：
    ```markdown
    | データ型          | 説明                                              |
    |:--------------|:------------------------------------------------|
    | `timetz`      | 入力/出力: 特定タイムゾーンにおける時刻<br>**保持: UTC における時刻**     |
    ```

- **セル内の強調**
  - 表内でも太字やコードフォーマットを使用
  - 例：
    ```markdown
    | 分離レベル         | 説明                                |
    |:--------------|:----------------------------------|
    | **READ COMMITTED**<br>**[Default]** | デフォルトの分離レベル |
    ```

### 8.3 表での情報整理

- **比較表**
  - 例：RDBMS ごとの違い
  - 例：分離レベルごとのアノマリー発生状況

- **定義表**
  - 例：データ型の一覧
  - 例：エラーメッセージの一覧

---

## 9. 図表・視覚的要素

### 9.1 Mermaid の使用

- **フローチャート**
  - 依存関係の可視化
  - 例：
    ```markdown
    ```mermaid
    graph TD
        FR(FormRequest) --> C(Container)
        FR --> R(Redirector)
    ```
    ```

### 9.2 コードブロックの言語指定

- **適切な言語指定**
  - `php`, `sql`, `go`, `yaml`, `json`, `diff` など
  - シンタックスハイライトを活用

### 9.3 画像の挿入

- **GitHub からの画像引用**
  - 例：`![postgres](https://github.com/mpyw/zenn/assets/1351893/7a078746-c265-4ba1-baf7-55e2bbb92d3d)`

---

## 10. 特殊な表現パターン

### 10.1 引用の使い方

- **引用ブロック**
  - `>` で引用を表現
  - 公式ドキュメントやコードの引用
  - 例：
    ```markdown
    > ```php
    > $this->app->afterResolving(ValidatesWhenResolved::class, function ($resolved) {
    >     $resolved->validateResolved();
    > });
    > ```
    ```

### 10.2 否定の強調

- **「〜してはならない」**
  - 例：「なぜ Go ではロガーをコンストラクタ DI してはならないのか」

- **「〜してはいけません」**
  - 例：「一貫性が欲しい部分でそれらを併用してはならない。」

- **「決して〜しないでください」**
  - 例：「みなさんは決して同じ轍を踏まないでください。」

### 10.3 理由の説明

- **「〜ためです」「〜からです」**
  - 例：「これは〜であるためです。」

- **「〜ゆえに」**
  - 例：「〜が採用されているがゆえに」

- **「〜に起因して」**
  - 例：「タイムゾーンに起因するトラブル」

### 10.4 条件の提示

- **「もし〜であれば」**
  - 例：「もし範囲型を採用する場合は，是非入れて欲しいライブラリです。」

- **「〜の場合は」**
  - 例：「競合頻度が低い場合，楽観的制御の振る舞いに身を任せたほうがパフォーマンスが出る場合があると考えられる。」

### 10.5 推測・判断の表現

- **「〜と考えられる」「〜と思われる」**
  - 例：「これも簡単のために 1 つにまとめる。」
  - 例：「実用上の問題は無いため考慮しない考え方が一般的であるようだ。」

- **「〜だろう」「〜でしょう」**
  - 例：「最低限のロガーの責務を満たすためには詳細な設定はなくてもいいと判断できる場合，デフォルトのロガーをフォールバックとして提供することもまた考えられます。」

---

## 11. 脚注の使い方

- **`[^1]` 形式で脚注**
  - 例：
    ```markdown
    実はPHP 公式マニュアルでも触れられてはいます[^1]。

    [^1]: [PHP: ジェネレータの構文 - Manual # yield from によるジェネレータの委譲](https://www.php.net/manual/ja/language.generators.syntax.php#control-structures.yield.from)
    ```

---

## 12. メタ情報（Front Matter）

### 12.1 基本構造

```yaml
---
title: "記事のタイトル"
emoji: "🕰️"
type: "tech"
topics: ["php", "laravel", "datetime", "database", "postgresql"]
published: true
---
```

### 12.2 タイトルの付け方

- **具体的で分かりやすく**
  - 例：「後悔しない日付時刻・タイムゾーン設計と Laravel での実践法」
  - 例：「Laravel の FormRequest バリデーションの動きに忠実なテスト方法を考える」

- **問いかけ形式**
  - 例：「なぜ Go ではロガーをコンストラクタ DI してはならないのか」

- **中黒「・」で区切る**
  - 例：「MySQL/Postgres におけるトランザクション分離レベルと発生するアノマリーを整理する」

### 12.3 トピックの選び方

- **主要な技術スタック**
  - 言語：`php`, `go`
  - フレームワーク：`laravel`
  - データベース：`database`, `postgresql`, `mysql`
  - 概念：`datetime`, `transaction`, `validation`, `test`

---

## 13. 文章の流れとリズム

### 13.1 段落の長さ

- **1段落は3〜5文程度**
  - 長すぎる段落は避ける
  - 適度に改行して読みやすく

### 13.2 接続詞の使い方

- **逆接**：「しかし」「ところが」「一方で」
  - 例：「ところが，実際は〜」

- **順接**：「そして」「また」「さらに」
  - 例：「さらにその前に使用する RDBMS を決めなければなりませんね。」

- **並列**：「また」「加えて」「更に」
  - 例：「また案件の規模によって採用されたりされなかったりの差はあると思いますが」

### 13.3 文章のリズム感

- **短文と長文の組み合わせ**
  - 単調にならないよう変化をつける
  - 例：
    ```
    良いですね！ローカル日付がタイムゾーン上の日付時刻に変換されるまでの過程が，全て明示的に記載されています。暗黙的に処理するよりもずっとバグが生まれにくい，安全なコードになっていることが伝わるでしょうか？
    ```

---

## 14. 技術的な正確性

### 14.1 情報源の明示

- **公式ドキュメントへのリンク**
  - 例：`https://www.postgresql.org/docs/current/datatype-datetime.html`

- **参考記事の列挙**
  - 複数のソースを提示

### 14.2 バージョン情報

- **該当する場合はバージョンを明記**
  - 例：「2023年9月2日 現在」
  - 例：「Laravel 7 以降」

### 14.3 実験・検証の明示

- **実際の動作を確認した場合**
  - 例：「実際に接続のタイムゾーン設定の影響を Laravel アプリケーションが受ける領域は限定的です。」

---

## 15. 読者への配慮

### 15.1 難易度の調整

- **前提知識の明示**
  - 例：「ANSI 定義の古典的なトランザクション分離レベルとアノマリーは概ね理解している」

- **段階的な説明**
  - 基礎から応用へ
  - 簡単な例から複雑な例へ

### 15.2 注意喚起

- **「注意！」「重要！」**
  - Zenn の `:::message alert` を活用
  - 例：
    ```markdown
    :::message alert
    **`REPEATABLE READ` 以上でも，Locking Read/Write では `READ COMMITTED` でロックを取る相当の動作になってしまう仕様となっている。**
    :::
    ```

### 15.3 補足情報の提供

- **「ちなみに」「なお」**
  - 例：「ちなみにこの `'request'` という文字列ですが，」

- **折りたたみで詳細を隠す**
  - 本文の流れを邪魔しない配慮

---

## 16. 実践的なアドバイス

### 16.1 ベストプラクティスの提示

- **「推奨」「おすすめ」**
  - 例：「基本的には **`READ COMMITTED`** をベースにした上で **Locking Read** を活用せよ。」

### 16.2 アンチパターンの指摘

- **「〜してはならない」**
  - 例：「一貫性が欲しい部分でそれらを併用してはならない。」

### 16.3 トレードオフの説明

- **「〜の一方で」「メリット・デメリット」**
  - 例：「長所・短所」のセクションで整理

---

## チェックリスト

記事を執筆・レビューする際は，以下の点を必ず確認してください。

- [ ] **読点に「，」（全角カンマ）を使用している**
- [ ] **英数字の前後に半角スペースを入れている**
- [ ] 重要箇所を **太字** で強調している
- [ ] コードにわかりやすい日本語コメントを付けている
- [ ] 見出しは階層的で分かりやすい
- [ ] 「はじめに」で背景・動機を説明している
- [ ] 適切に Zenn 記法（`:::message` など）を活用している
- [ ] 表で情報を整理している
- [ ] 参考文献・リンクを提示している
- [ ] 「まとめ」で要点を箇条書きにしている

---

**このガイドに従うことで，一貫性のある読みやすい技術記事を執筆できます。**
